<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Neon Dodger: Apple Mode</title>
<style>
  body{margin:0;overflow:hidden;background:#050c18;}
  canvas{display:block;margin:0 auto;}
</style>
</head>
<body>
<canvas id="game"></canvas>
<script>
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

let player={x:canvas.width/2,y:canvas.height-100,r:20,speed:8,color:'#0ff'};
let obstacles=[];
let apples=[];
let keys={};
let score=0;
let gameOver=false;
let spawnInterval=1500;
let lastSpawn=0;
let appleInterval=3000;
let lastApple=0;
let startTime=performance.now();

class Obstacle{
  constructor(){
    this.x=Math.random()*(canvas.width-40)+20;
    this.y=-30;
    this.r=15+Math.random()*15;
    this.speed=2+Math.random()*3;
    this.color='#ff0';
  }
  update(){ this.y+=this.speed; }
  draw(){ ctx.beginPath();ctx.arc(this.x,this.y,this.r,0,Math.PI*2);ctx.fillStyle=this.color;ctx.shadowColor=this.color;ctx.shadowBlur=20;ctx.fill(); }
}

class Apple{
  constructor(){
    this.x=Math.random()*(canvas.width-40)+20;
    this.y=Math.random()*(canvas.height-200)+50;
    this.r=15;
    this.color='#ff4f4f';
  }
  draw(){ ctx.beginPath();ctx.arc(this.x,this.y,this.r,0,Math.PI*2);ctx.fillStyle=this.color;ctx.shadowColor=this.color;ctx.shadowBlur=20;ctx.fill(); }
}

function spawnObstacle(){ obstacles.push(new Obstacle()); }
function spawnApple(){ apples.push(new Apple()); }

function update(){
  if(gameOver) return;
  const now=performance.now();
  if(now-lastSpawn>spawnInterval){spawnObstacle();lastSpawn=now;}
  if(now-lastApple>appleInterval){spawnApple();lastApple=now;}

  if(keys['ArrowLeft'] && player.x-player.r>0) player.x-=player.speed;
  if(keys['ArrowRight'] && player.x+player.r<canvas.width) player.x+=player.speed;
  if(keys['ArrowUp'] && player.y-player.r>0) player.y-=player.speed;
  if(keys['ArrowDown'] && player.y+player.r<canvas.height) player.y+=player.speed;

  obstacles.forEach((o,i)=>{
    o.update();
    if(Math.hypot(o.x-player.x,o.y-player.y)<o.r+player.r){gameOver=true;}
    if(o.y>canvas.height+50) obstacles.splice(i,1);
  });

  apples.forEach((a,i)=>{
    if(Math.hypot(a.x-player.x,a.y-player.y)<a.r+player.r){
      score+=50; apples.splice(i,1);
    }
  });

  spawnInterval=Math.max(400,1500-((now-startTime)/1000)*20);
}

function draw(){
  ctx.fillStyle='rgba(5,12,24,0.3)';ctx.fillRect(0,0,canvas.width,canvas.height);

  player.draw=()=>{ctx.beginPath();ctx.arc(player.x,player.y,player.r,0,Math.PI*2);ctx.fillStyle=player.color;ctx.shadowColor=player.color;ctx.shadowBlur=20;ctx.fill();}
  player.draw();

  obstacles.forEach(o=>o.draw());
  apples.forEach(a=>a.draw());

  ctx.fillStyle='#bfe8ff';ctx.font='24px monospace';ctx.fillText('Score: '+score,20,40);

  if(gameOver){ctx.fillStyle='rgba(0,0,0,0.6)';ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle='#ff7f7f';ctx.font='56px monospace';ctx.textAlign='center';
    ctx.fillText('GAME OVER',canvas.width/2,canvas.height/2-20);
    ctx.font='24px monospace';ctx.fillStyle='#bfe8ff';ctx.fillText('Press R to Restart',canvas.width/2,canvas.height/2+30);}
}

function loop(){update();draw();requestAnimationFrame(loop);}
window.addEventListener('keydown',e=>{keys[e.key]=true;if(e.key==='r' && gameOver){restart();}});
window.addEventListener('keyup',e=>{keys[e.key]=false;});
function restart(){obstacles=[];apples=[];score=0;gameOver=false;player.x=canvas.width/2;player.y=canvas.height-100;startTime=performance.now();spawnInterval=1500;lastSpawn=0;lastApple=0;}
loop();
</script>
</body>
</html>
